<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Adding decoders | Theengs decoder</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="apple-touch-icon" sizes="180x180" href=".apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="One decoder for many devices, decode easily your BLE devices data and transform these into a readable format">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/favicon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.e43f3e2e.css" as="style"><link rel="preload" href="/assets/js/app.b24af4a3.js" as="script"><link rel="preload" href="/assets/js/2.61da0793.js" as="script"><link rel="preload" href="/assets/js/81.d8f27c5f.js" as="script"><link rel="prefetch" href="/assets/js/10.97a4614e.js"><link rel="prefetch" href="/assets/js/11.ed060bd5.js"><link rel="prefetch" href="/assets/js/12.8c4f9b88.js"><link rel="prefetch" href="/assets/js/13.fe1f182a.js"><link rel="prefetch" href="/assets/js/14.fb965796.js"><link rel="prefetch" href="/assets/js/15.bf8f89ba.js"><link rel="prefetch" href="/assets/js/16.0dfac8cc.js"><link rel="prefetch" href="/assets/js/17.33b6ae48.js"><link rel="prefetch" href="/assets/js/18.cb3ac7df.js"><link rel="prefetch" href="/assets/js/19.d9b40920.js"><link rel="prefetch" href="/assets/js/20.dd9939ad.js"><link rel="prefetch" href="/assets/js/21.d559cf46.js"><link rel="prefetch" href="/assets/js/22.22aec905.js"><link rel="prefetch" href="/assets/js/23.ed6e3ba5.js"><link rel="prefetch" href="/assets/js/24.07e12630.js"><link rel="prefetch" href="/assets/js/25.905de64a.js"><link rel="prefetch" href="/assets/js/26.c6dc5d5d.js"><link rel="prefetch" href="/assets/js/27.3351d9ce.js"><link rel="prefetch" href="/assets/js/28.0bbee35c.js"><link rel="prefetch" href="/assets/js/29.735edbdd.js"><link rel="prefetch" href="/assets/js/3.c5aa1bd1.js"><link rel="prefetch" href="/assets/js/30.7e1df087.js"><link rel="prefetch" href="/assets/js/31.24abd449.js"><link rel="prefetch" href="/assets/js/32.0fc16a07.js"><link rel="prefetch" href="/assets/js/33.1755b293.js"><link rel="prefetch" href="/assets/js/34.5dddec5c.js"><link rel="prefetch" href="/assets/js/35.7d0d0a00.js"><link rel="prefetch" href="/assets/js/36.12567cb5.js"><link rel="prefetch" href="/assets/js/37.2b692f0b.js"><link rel="prefetch" href="/assets/js/38.775d7df9.js"><link rel="prefetch" href="/assets/js/39.ab69fb4a.js"><link rel="prefetch" href="/assets/js/4.95a49d65.js"><link rel="prefetch" href="/assets/js/40.a6b12371.js"><link rel="prefetch" href="/assets/js/41.283d1cfe.js"><link rel="prefetch" href="/assets/js/42.9dc0b0cd.js"><link rel="prefetch" href="/assets/js/43.56cc3d06.js"><link rel="prefetch" href="/assets/js/44.eb75fa52.js"><link rel="prefetch" href="/assets/js/45.9a7aa74c.js"><link rel="prefetch" href="/assets/js/46.0c336bd2.js"><link rel="prefetch" href="/assets/js/47.28126d4f.js"><link rel="prefetch" href="/assets/js/48.d474c425.js"><link rel="prefetch" href="/assets/js/49.1e50b605.js"><link rel="prefetch" href="/assets/js/5.1773ec77.js"><link rel="prefetch" href="/assets/js/50.4337871f.js"><link rel="prefetch" href="/assets/js/51.c28f5443.js"><link rel="prefetch" href="/assets/js/52.31a31253.js"><link rel="prefetch" href="/assets/js/53.ef5f6a32.js"><link rel="prefetch" href="/assets/js/54.eed9d5b3.js"><link rel="prefetch" href="/assets/js/55.d8b528d8.js"><link rel="prefetch" href="/assets/js/56.ebe36de0.js"><link rel="prefetch" href="/assets/js/57.4bccc7ef.js"><link rel="prefetch" href="/assets/js/58.e22de9c3.js"><link rel="prefetch" href="/assets/js/59.4d5b92cb.js"><link rel="prefetch" href="/assets/js/6.11220e48.js"><link rel="prefetch" href="/assets/js/60.6fe43f91.js"><link rel="prefetch" href="/assets/js/61.eb37dcdf.js"><link rel="prefetch" href="/assets/js/62.f1e03bd9.js"><link rel="prefetch" href="/assets/js/63.9639f543.js"><link rel="prefetch" href="/assets/js/64.1b10c926.js"><link rel="prefetch" href="/assets/js/65.303244fb.js"><link rel="prefetch" href="/assets/js/66.a59d9c3a.js"><link rel="prefetch" href="/assets/js/67.174510e9.js"><link rel="prefetch" href="/assets/js/68.2a0c85f1.js"><link rel="prefetch" href="/assets/js/69.4a404585.js"><link rel="prefetch" href="/assets/js/7.86b99980.js"><link rel="prefetch" href="/assets/js/70.e3a15c14.js"><link rel="prefetch" href="/assets/js/71.92f9a9a8.js"><link rel="prefetch" href="/assets/js/72.fb5977c6.js"><link rel="prefetch" href="/assets/js/73.950d78bd.js"><link rel="prefetch" href="/assets/js/74.bf574d0a.js"><link rel="prefetch" href="/assets/js/75.bd42cfbc.js"><link rel="prefetch" href="/assets/js/76.18f10385.js"><link rel="prefetch" href="/assets/js/77.c9b9384c.js"><link rel="prefetch" href="/assets/js/78.add52716.js"><link rel="prefetch" href="/assets/js/79.c1b2f910.js"><link rel="prefetch" href="/assets/js/8.8f4fe73a.js"><link rel="prefetch" href="/assets/js/80.0b4faf14.js"><link rel="prefetch" href="/assets/js/82.d3626019.js"><link rel="prefetch" href="/assets/js/83.12b29139.js"><link rel="prefetch" href="/assets/js/84.8f6991c2.js"><link rel="prefetch" href="/assets/js/85.b450c849.js"><link rel="prefetch" href="/assets/js/86.06c669c1.js"><link rel="prefetch" href="/assets/js/9.e4fac89a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e43f3e2e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Theengs decoder</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://shop.theengs.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Shop🆕
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.theengs.io" target="_self" class="nav-link external">
  Home
  <!----></a></div><div class="nav-item"><a href="https://app.theengs.io" target="_self" class="nav-link external">
  App
  <!----></a></div><div class="nav-item"><a href="https://gateway.theengs.io" target="_self" class="nav-link external">
  Gateway
  <!----></a></div><div class="nav-item"><a href="https://decoder.theengs.io" target="_self" class="nav-link external">
  Decoder
  <!----></a></div> <a href="https://github.com/theengs/decoder" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://shop.theengs.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Shop🆕
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.theengs.io" target="_self" class="nav-link external">
  Home
  <!----></a></div><div class="nav-item"><a href="https://app.theengs.io" target="_self" class="nav-link external">
  App
  <!----></a></div><div class="nav-item"><a href="https://gateway.theengs.io" target="_self" class="nav-link external">
  Gateway
  <!----></a></div><div class="nav-item"><a href="https://decoder.theengs.io" target="_self" class="nav-link external">
  Decoder
  <!----></a></div> <a href="https://github.com/theengs/decoder" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">0 - What is it for 🏠</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>1 - Devices 🌡️</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2 - Use ✈️</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>3 - Participate 💻</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/participate/adding-decoders.html" aria-current="page" class="active sidebar-link">Adding decoders</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/participate/support.html" class="sidebar-link">Supporting the project</a></li><li><a href="/participate/development.html" class="sidebar-link">Development contributions</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="adding-decoders"><a href="#adding-decoders" class="header-anchor">#</a> Adding decoders</h1> <p>Adding your device protocol to Theengs decoder enable to increase interoperability and to create new use cases with your device. You will find below some guidance to do that.</p> <p>You can do a pull request directly to the <a href="https://github.com/theengs/decoder" target="_blank" rel="noopener noreferrer">Repository<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h1 id="adding-device-decoding"><a href="#adding-device-decoding" class="header-anchor">#</a> Adding device decoding</h1> <p>Device decode specifications are located in a json file, example <a href="../../src/device_json.h">HHCCJCY01HHCC_json.h</a>. The format is:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>R&quot;&quot;&quot;&quot;(
{
   &quot;brand&quot;:&quot;Xiaomi&quot;,
   &quot;model&quot;:&quot;miflora&quot;,
   &quot;model_id&quot;:&quot;HHCCJCY01HHCC&quot;,
   &quot;condition&quot;:[&quot;servicedata&quot;, &quot;contain&quot;, &quot;209800&quot;],
   &quot;properties&quot;:{
      &quot;tempc&quot;:{
         &quot;condition&quot;:[&quot;servicedata&quot;, 25, &quot;4&quot;],
         &quot;decoder&quot;:[&quot;value_from_hex_data&quot;, &quot;servicedata&quot;, 30, 4, true],
         &quot;post_proc&quot;:[&quot;/&quot;, 10]
      },
      &quot;moi&quot;:{
         &quot;condition&quot;:[&quot;servicedata&quot;, 25, &quot;8&quot;],
         &quot;decoder&quot;:[&quot;value_from_hex_data&quot;, &quot;servicedata&quot;, 30, 2, false]
      },
      &quot;lux&quot;:{
         &quot;condition&quot;:[&quot;servicedata&quot;, 25, &quot;7&quot;],
         &quot;decoder&quot;:[&quot;value_from_hex_data&quot;, &quot;servicedata&quot;, 30, 6, true]
      },
      &quot;fer&quot;:{
         &quot;condition&quot;:[&quot;servicedata&quot;, 25, &quot;9&quot;],
         &quot;decoder&quot;:[&quot;value_from_hex_data&quot;, &quot;servicedata&quot;, 30, 4, true]
      }
   }
})&quot;&quot;&quot;&quot;,
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>Each device must provide a <code>brand</code>, <code>model</code>, <code>model_id</code>, <code>condition</code>, and <code>properties</code>.</p> <ul><li><code>brand</code> = brand name of the device.</li> <li><code>model</code> = model name of the device.</li> <li><code>model_id</code> = model id number of the device.</li></ul> <h4 id="manufacturer-id-compliance"><a href="#manufacturer-id-compliance" class="header-anchor">#</a> Manufacturer ID Compliance</h4> <p>Whenever a decoder is based on &quot;manufacturerdata&quot; and the first bytes do not comply with the <a href="https://www.bluetooth.com/specifications/assigned-numbers/company-identifiers/" target="_blank" rel="noopener noreferrer">Bluetooth SIG's company identifier convention<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, an additional device property <code>&quot;cidc&quot;</code> should be added to the decoder, set to false.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>   &quot;brand&quot;:&quot;Govee&quot;,
   &quot;model&quot;:&quot;Thermo Hygrometer&quot;,
   &quot;model_id&quot;:&quot;H5072&quot;,
   &quot;cidc&quot;:false,
   …
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="condition"><a href="#condition" class="header-anchor">#</a> Condition</h3> <p><code>condition</code> is a JSON array, which must contain as the first parameter, the data source to test for the condition. Valid inputs are:</p> <ul><li>&quot;servicedata&quot;</li> <li>&quot;manufacturerdata&quot;</li> <li>&quot;name&quot;</li> <li>&quot;uuid&quot;</li></ul> <p>The second parameter is variable. If required, further qualification can be made by setting a conditional data length in the case of &quot;servicedata&quot; or &quot;manufacturerdata&quot; as the first condition. This is an operator in the form of <code>&quot;&gt;&quot; , &quot;&gt;=&quot; , &quot;=&quot; , &quot;&lt;&quot; , &quot;&lt;=&quot;</code> followed by the third parameter being a numeric value that specifies the length of the data to accept. If no data length is defined the second parameter must indicate how the data should be tested. Valid inputs are:</p> <ul><li>&quot;contain&quot; tests if the specified value (see below) exists the data source</li> <li>&quot;index&quot; tests if the specified value exists at the index location (see below) in the data source</li></ul> <p>Examples:
<code>&quot;condition&quot;:[&quot;servicedata&quot;, &quot;index&quot;, 0, &quot;0804&quot;</code> -- no data length check
<code>&quot;condition&quot;:[&quot;servicedata&quot;, &quot;&gt;=&quot;, 40, &quot;index&quot;, 0, &quot;0804&quot;</code> -- data length must be equal to or greater than 40 bytes</p> <p>The third parameter (fifth if data length is specified) can be either the index value or the data value to find. If the second (fourth if data length specified) parameter is <code>contain</code>, the next parameter should be the value to look for in the data source. If the second (fourth if data length specified) parameter is <code>index</code>, the next parameter should be the location in the data source to look for the value.</p> <p><code>condition</code> can have multiple conditions chained together using &quot;|&quot; and &quot;&amp;&quot; between them.<br>
For example: <code>&quot;condition&quot;:[&quot;servicedata&quot;, &quot;index&quot;, 0, &quot;0804&quot;, &quot;|&quot;, &quot;servicedata&quot;, &quot;index&quot;, 0, &quot;8804&quot;]</code><br>
This will match if the service data at index 0 is &quot;0804&quot; <code>OR</code> &quot;8804&quot;.</p> <p><code>condition</code> can contain JSON arrays that can be processed separately. This allows for nesting of detection tests such as:<br> <code>&quot;condition&quot;: [[&quot;servicedata&quot;, &quot;index&quot;, 0, &quot;1234&quot;, &quot;&amp;&quot; &quot;servicedata&quot;, &quot;index&quot;, 5, &quot;5678&quot;], &quot;|&quot;, &quot;servicedata&quot;, &quot;index&quot;, 30, &quot;abcd&quot;]</code><br>
This will result in a positive detection if the service data at index <code>0</code> == <code>0x1234</code> and the service data at index <code>5</code> == <code>0x5678</code>, otherwise, if the service data at index <code>30</code> == <code>0xabcd</code>, the result will also be positive.</p> <div class="custom-block warning"><p class="custom-block-title">Note</p> <p>Nesting is discouraged from use wherever possible as the recursive nature may cause stack overflowing in some circumstances.
It should only be used if absolutely necessary, as in the above example.
If all the conditions in an array bracket are chained with &quot;|&quot;, as in
<code>&quot;condition&quot;: [[&quot;servicedata&quot;, &quot;index&quot;, 0, &quot;abcd&quot;, &quot;|&quot;, &quot;servicedata&quot;, &quot;index&quot;, 0, &quot;efef&quot;], &quot;&amp;&quot;, &quot;servicedata&quot;, &quot;index&quot;, 5, &quot;1212&quot;]</code>
this could be re-written as
<code>&quot;condition&quot;: [&quot;servicedata&quot;, &quot;index&quot;, 0, &quot;abcd&quot;, &quot;|&quot;, &quot;servicedata&quot;, &quot;index&quot;, 0, &quot;efef&quot;, &quot;&amp;&quot;, &quot;servicedata&quot;, &quot;index&quot;, 5, &quot;1212&quot;]</code><br>
making sure the additional AND condition is at the end. This has the same result, without nesting.</p></div> <p><code>condition</code> NOT(!) testing; Anytime a condition test value is preceded by a &quot;!&quot;, the inverse of the result will be used to determine the result.<br>
Example: `&quot;condition&quot;: [&quot;servicedata&quot;, &quot;index&quot;, 30, &quot;!&quot;, &quot;abcd&quot;, &quot;&amp;&quot;, &quot;servicedata&quot;, &quot;index&quot;, 0, &quot;1234&quot;]<br>
If the value of the service data at index 30 is not 0xabcd and the data at index 0 is 0x1234, the result is a positive detection.</p> <h3 id="properties"><a href="#properties" class="header-anchor">#</a> Properties</h3> <p>Properties is a nested JSON object containing one or more JSON objects. In the example above it looks like:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> &quot;properties&quot;:{
      &quot;tempc&quot;:{
         &quot;condition&quot;:[&quot;servicedata&quot;, 25, &quot;4&quot;],
         &quot;decoder&quot;:[&quot;value_from_hex_data&quot;, &quot;servicedata&quot;, 30, 4, true],
         &quot;post_proc&quot;:[&quot;/&quot;, 10]
      },
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Here we have a single property that defines a value that we want to decode. The key &quot;tempc&quot; will be used as the key in the JsonObject provided when <code>decodeBLEJson(JsonObject)</code> is called. &quot;tempc&quot; in this example is another JSON object that has an (optional, explained below) <code>condition</code>, <code>decoder</code>, and <code>post_proc</code>.</p> <p><code>condition</code> is a JSON array. The first parameter defines the data source of the condition to test and must be one of:</p> <ul><li>&quot;servicedata&quot;</li> <li>&quot;manufacturerdata&quot;</li></ul> <p>The second parameter is the index of the data source to look for the value. Then the third parameter is the value to test for.</p> <p>If a direct binary bit evaluation encoded in a hex digit is desired the third parameter is <code>&quot;bit&quot;</code>, the fourth parameter the bit position from <code>3-0</code> and the fifth parameter the bit state <code>0</code> or <code>1</code>.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> &quot;properties&quot;:{
      &quot;hum&quot;:{
         &quot;condition&quot;:[&quot;servicedata&quot;, 10, &quot;bit&quot;, 3, 0],
         &quot;decoder&quot;:[&quot;value_from_hex_data&quot;, &quot;servicedata&quot;, 10, 2, false, false]
      },
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>The second parameter can also be an operator in the form of <code>&quot;&gt;&quot; , &quot;&gt;=&quot; , &quot;=&quot; , &quot;&lt;&quot; , &quot;&lt;=&quot;</code>, then followed by the third parameter being a numeric value that specifies the length of the data to accept for evaluation of the first parameter.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> &quot;properties&quot;:{
      &quot;tempc&quot;:{
         &quot;condition&quot;:[&quot;manufacturerdata&quot;, &quot;=&quot;, 40],
         &quot;decoder&quot;:[&quot;value_from_hex_data&quot;, &quot;manufacturerdata&quot;, 24, 4, true]
      },
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>If the condition is met the data will be decoded and added to the JsonObject.</p> <p><code>condition</code> can contain JSON arrays that can be processed separately. This allows for nesting of detection tests such as:<br> <code>&quot;condition&quot;: [[&quot;servicedata&quot;, 25, &quot;4&quot;, &quot;&amp;&quot; &quot;servicedata&quot;, 26, &quot;5&quot;], &quot;|&quot;, &quot;servicedata&quot;, 30, &quot;abcd&quot;]</code><br>
This will result in a positive detection if the service data at index <code>25</code> == <code>4</code> and the service data at index <code>26</code> == <code>5</code>, otherwise, if the service data at index <code>30</code> == <code>0xabcd</code>, the result will also be positive.</p> <div class="custom-block warning"><p class="custom-block-title">Note</p> <p>Nesting is discouraged from use wherever possible as the recursive nature may cause stack overflowing in some circumstances.
It should only be used if absolutely necessary, as in the above example.
If all the conditions in an array bracket are chained with &quot;|&quot;, as in
<code>&quot;condition&quot;: [[&quot;servicedata&quot;, 20, &quot;5&quot;, &quot;|&quot;, &quot;servicedata&quot;, 20, &quot;6&quot;], &quot;&amp;&quot;, &quot;servicedata&quot;, 30, &quot;a&quot;]</code>
this could be re-written as
<code>&quot;condition&quot;: [&quot;servicedata&quot;, 20 , &quot;5&quot;, &quot;|&quot;, &quot;servicedata&quot;, 20, &quot;6&quot;, &quot;&amp;&quot;, &quot;servicedata&quot;, 30, &quot;a&quot;]</code><br>
making sure the additional AND condition is at the end. This has the same result, without nesting.</p></div> <p>Property conditions also allow for a NOT comparison, as in</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> &quot;properties&quot;:{
      &quot;tempc&quot;:{
         &quot;condition&quot;:[&quot;manufacturerdata&quot;, 24, &quot;!&quot;, &quot;ffff&quot;],
         &quot;decoder&quot;:[&quot;value_from_hex_data&quot;, &quot;manufacturerdata&quot;, 24, 4, true, false],
         &quot;post_proc&quot;:[&quot;/&quot;, 10]
      },
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>where then the fourth parameter is the value to test for.</p> <div class="custom-block warning"><p class="custom-block-title">Note</p> <p>The NOT comparison is case sensitive! Therefor any NOT comparisons should be defined in lower case, as this is the format in which devices' &quot;servicedata&quot; and &quot;manufacturerdata&quot; are being reported.</p></div> <p><code>decoder</code> is a JSON array that specifies the decoder function and parameters to decode the value.
The first parameter is the name of the function to call, The available functions are:</p> <ul><li>&quot;value_from_hex_data&quot;  - converts the hex string value into an <code>integer</code> or <code>double</code> type.</li> <li>&quot;bf_value_from_hex_data&quot; - converts the (binary fraction) hex string value into a <code>double</code> type.  This should be used when the hex data is represented in the format of <code>XX.XX</code>. For example: when <code>0x1a1e</code> should output 26.30.</li> <li>&quot;string_from_hex_data&quot; - converts the hex value to a string type.</li> <li>&quot;static_value&quot; - sets the value to the static value specified if the condition is met.</li> <li>&quot;bit_static_value&quot; - sets the value to either one of two given values, depending on the evaluated binary bit.</li></ul> <p>The other parameters for the first three functions are:</p> <ul><li>&quot;servicedata&quot; or &quot;manufacturerdata&quot; Extract the value from the specified data.</li> <li>24, The index of the data source where the value exists.</li> <li>4, The length of the data in bytes (characters in the string).
and additional boolean parameters applicable to the first two functions:</li> <li>true/false, If the value in the data source should have it's endianness reversed before converting.</li> <li>(optional)true/false, Sets if the resulting value can be a negative number. Defaults to true when omitted.</li> <li>(optional)false/true, Sets if the &quot;value_from_hex_data&quot; decoding result is a <code>float</code> instead of an <code>integer</code> type. Defaults to false when omitted.</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code> &quot;properties&quot;:{
      &quot;unit&quot;:{
         &quot;decoder&quot;:[&quot;bit_static_value&quot;, &quot;servicedata&quot;, 1, 0, &quot;kg&quot;, &quot;lb&quot;]
      },
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The parameters for the &quot;bit_static_value&quot; function are:</p> <ul><li>&quot;servicedata&quot; or &quot;manufacturerdata&quot; - extract the value from the specified data.</li> <li>1, the index of the data source where the value exists.</li> <li>0, the bit position from <code>3-0</code>.</li> <li>The return value for bit state <code>0</code>.</li> <li>The return value for bit state <code>1</code>.</li></ul> <p><code>post_proc</code> This specifies any post processing of the resulting decoded value. This is a JSON array that should be written in the order that the operation order is desired. In the simple example the first parameter is the &quot;/&quot; divide operation and the second parameter (10) is the value to divide the result by. Multiple operations can be chained together in this array to perform more complex calculations.</p> <p>Valid operations are:</p> <ul><li>&quot;/&quot; divide</li> <li>&quot;*&quot; multiply</li> <li>&quot;+&quot; add</li> <li>&quot;-&quot; subtract</li> <li>&quot;%&quot; modulo</li> <li>&quot;&lt;&quot; shift left</li> <li>&quot;&gt;&quot; shift right</li> <li>&quot;!&quot; Not (invert), useful for bool types</li> <li>&quot;&amp;&quot; Logical And the values</li> <li>&quot;min&quot; the minimum allowed value</li> <li>&quot;max&quot; the maximum allowed value</li></ul> <h4 id="special-property-cal"><a href="#special-property-cal" class="header-anchor">#</a> Special property .cal</h4> <p>.cal is a special property that can extracted from the provided data and used in calculations of other properties following it's definition. For example:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;properties&quot;:{
      &quot;.cal&quot;:{
         &quot;decoder&quot;:[&quot;value_from_hex_data&quot;, &quot;manufacturerdata&quot;, 16, 4, true],
         &quot;post_proc&quot;:[&quot;&amp;&quot;, 16383]
      },
      &quot;power&quot;:{
         &quot;decoder&quot;:[&quot;value_from_hex_data&quot;, &quot;manufacturerdata&quot;, 4, 4, true],
         &quot;post_proc&quot;:[&quot;/&quot;, &quot;.cal&quot;, &quot;*&quot;, 60000]
      }
   }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>Here the calculation value extracted first from the data stream and used by the next property to calculate the data value.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/theengs/decoder/edit/development/docs/participate/adding-decoders.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/12/2023, 3:57:17 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/use/python.html" class="prev">
        Using with Python
      </a></span> <span class="next"><a href="/participate/support.html">
        Supporting the project
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b24af4a3.js" defer></script><script src="/assets/js/2.61da0793.js" defer></script><script src="/assets/js/81.d8f27c5f.js" defer></script>
  </body>
</html>
